<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Election Status Console (Local Mode)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load React and Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Configure Tailwind to use JIT and custom styles -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        // Custom colors matching the app logic
                        'yellow-600': '#ca8a04',
                        'yellow-700': '#a16207',
                        'yellow-500': '#eab308',
                        'yellow-100': '#fefce8',
                        'blue-600': '#2563eb',
                        'blue-700': '#1d4ed8',
                        'blue-100': '#eff6ff',
                        'indigo-600': '#4f46e5',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans">

<div id="root"></div>

<script type="text/babel">
const useState = React.useState;
const useEffect = React.useEffect;
const useMemo = React.useMemo;

// --- CONFIGURATION ---
const ADMIN_PASSWORD = 'AUT2025';
const COLORS = ['#eab308', '#2563eb']; // Yellow-500 for Elected, Blue-600 for Not Elected

// --- ICON Definitions (Simplified for Local Mode) ---
const icons = {
  Users: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
  Trophy: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5h2a2.5 2.5 0 0 1 0 5"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5h-2a2.5 2.5 0 0 0 0 5"/><path d="M10 17H8l-1 2H5l1-2v-3.6L2.5 9h19L18 13.4V17h-2l-1-2h-1"/><path d="M14 17h-4l-1 2H9"/></svg>,
  XCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>,
  Filter: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>,
  CheckCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>,
  Search: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
  Loader: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite" /></svg>
};

// --- INITIAL DATA (192 NAMES) ---
const NAME_LIST = [
"Abdallah Fadi Al Halaby", "Abdel Wahab Mazen Kabbout", "Abdelhamid Mahmoud Masri", "Abdo Fouad Tannous", "Adriano Gerald Bayeh",
"Ahmad Abd El Karim El Jundy", "Ahmad Hassan Miari", "Aisha Muhammad Esper", "Alaa Mohamad Kassem", "Ali Mostapha Taleb",
"Amer Mohammad Abed", "Amine Abdul Razzak Sattout", "Amira Abdullah Aboriala", "Anthony Bernard Ayoub", "Anthony Christian-Serge Jebara",
"Anthony Mikhael El Hayek", "Anthony Nizar Malek", "Anthony Sarkis Bou Toubia", "Anthony Sarkis Mjally", "Antoine Ibrahim Mazraani",
"Antoine Tony Franjieh", "Antonelli Miled Lichaa", "Antonio Bakhos Maatouk", "Antonio Dany Salame", "Antoun Rafly Diab",
"Anwar Abdallah Abou Ryala", "Asmaa Hassan Al-Ali", "Aya Hussein Damlakhi", "Badoui Boulos Ayoub", "Bassam Semaan Makary",
"Batoul Jamal Aweek", "Bedwany Joseph Abi Saba", "Bedwin Georges Al Moukhtafie", "Bilal Mostafa Hassoun", "Bilal Ramez Al Azzaz",
"Boutros Elias Mrad", "Carlos Leba Younes", "Cedra Hassan Dannawei", "Celina Mohamad Rima", "Celine Chadi Kaddoum",
"Celine Nidal Salha", "Ceren Jack Rizk", "Chady Fadi Dahdah", "Charbel Miled Sessine", "Charbel Badoui Nassif",
"Charbel Boulos Dib", "Charbel Georges Serhan", "Charbel Joseph Wadih", "Charbel Michel Nachmy", "Charbel Michel Nakad",
"Charbel Miled Lichaa", "Charbel Naaman El Teress", "Charbel Raymond Antoun Tawk", "Charbel Salim Frangieh", "Charbel Sami Saliba",
"Charbel Tony Jerr", "Chris Antonios Yaacoub", "Christian Najib Ibrahim", "Christina Ali Al Khoder", "Christina Riad Sahyoun",
"Clara Elias Elias", "Claudia Elias EL Khoury El Beainy", "Cynthia Joseph Raad", "Cynthia Mostapha Barakat", "Dalal Wadah Diab",
"Dana Raif Mufarrij", "Dany Maroun Tawk", "David Roumanos Knayer Douaihy", "Dolly Mostafa Chami", "Dominic Charbel Rouhana",
"Douaa Nasser Metlej", "Elena Elia Tlayji", "Elena Wadih Al Masry", "Elias Moussa Nehme", "Elie Badwi Bou Antoun",
"Elie Elias Elias", "Elie Ziad El Khoury", "Elio Daniel Kopty", "Emelie Najib Sassine", "Eva Ziad Makary",
"Fadi Ziad El Khoury", "Farah Ibrahim Chalabi", "Farah Sami Eid", "Fatima El Zahraa Nidal Khaled", "Firas Khaled Haj Khalil",
"Fouad Diaa Karam", "Fouad Mouhamed Chaaban Kashlan", "Gaelle Elias Zoghbi", "Galina Elias Dreihi El Yazigi", "Geoffrey Joseph Farah",
"George Samir Matta", "George Sayed Yammine", "Georges Fadi Kaddis", "Georges Farid Sarkis", "Ghassan Samer Baltaji",
"Ghazwa Amer Al Fawal", "Gilbert Elia El Khoury", "Grace Barrak Breich", "Graziella Joseph Antoun", "Hala Khaled Kayed",
"Hanan Khaled Khoder Kattar", "Hiba Fadi Ghalayini", "Hoda Lichaa Maroun", "Houssam Mohamad Bader Mohamad Bader",
"Ibrahim Wassim Al Bitar", "Imad George Darazi", "Imane Rabie Maarbani", "Islam Hadi El Jamal", "Israa Mohamad Kassem",
"Issam Wassim Shibly", "Jack Mtanios Wehbe", "Jad Bakhos Derjani", "Jad Amer Marhaba", "Jad Chadi Saadeh",
"Jad Edmond Barakat", "Jad Nasser Abo Ayed", "Jad Talal El Hallak", "Jad Youssef Tawk", "Jamal Radwan Al Said",
"Jana Mahmoud Khalil", "Jawad Hadi Hassoun", "Jean Claude Fariz El Chami", "Jennifer Charbel Boulos", "Jenny Tony Khattar",
"Jessy Chawki Nemer", "Joanna Kassem El Harrache", "Jocelyne Antoine Tawk", "Joe Georges Mouhawess", "Johnny Jergy El Mouhawss",
"Joseph Boulos Yammine", "Joseph Dib Frangieh", "Joseph Keyrouz Keyrouz", "Joseph Leba Youssef", "Joseph Sarkis Mjally",
"Joseph Sarkis Youssef", "Joseph Tony Chamoun", "Joy Youssef Younes", "Joya Tony Khattar", "Joya Youssef Tawk",
"Julie Atallah Salah", "Julie Joseph Abdo", "Karim Mohannad Hwalla", "Khaled Rami Karaali", "Khaled Walid Akkari",
"Khalil Sarkis Al Makary", "Lara Antoine Douaihy", "Lea Fadi Missy", "Leen Walid Obeid", "Luna Hani Haidar",
"Lutchia Miled Zeidan", "Maher Rami Karaali", "Maickel Badoui Mourani", "Majd Hilal Ahmad Agha Al Abdallah", "Majd Madian Al Nazer",
"Manuel Philippe Khoury Hanna", "Marcel Georges Semaan", "Maria Joseph Wadih", "Maria Milad Kanaan", "Mariane Mahmoud El Ali",
"Maroun Semaan Doueihy", "Martine Esper Al Haddad", "Mauricio Charbel Elias", "Maya Antonios Al-Rawady", "Mays Waleed Mkhiemir",
"Melhem Badoui Mourani", "Michael Joseph Hamaty", "Mira Mohamad Saade", "Mirna Samir Monla", "Mohamad Rabih Al Sabbagh",
"Mohamad Omar Tabbal", "Mohamad Rachid Haidar", "Monica Emil Bou Lattouf", "Mouffaq Mohammad Saada", "Myriam Jean Al Makary",
"Nadine Issam Zeidan", "Najwa Khaled Mhamad", "Nancy Rajai Mobachar", "Nour Alaa Rabaa", "Nourhan Houssam Eid",
"Omar Abdul Aziz Saleh Moussa", "Omar Fouad Khaled", "Omar Ghanem Sleem", "Omar Mohamad Barghache", "Omar Salah Hmaydan",
"Oussama Georges Saade", "Oussama Mohamad Al Masri", "Patrick Sayed Antoun", "Paul Joseph Slaymen", "Peter Pierre Mrad",
"Pierre Claude Bou Nehme", "Rachad Azzam El Merabi", "Rachid Abed El Hadi Dahabi", "Rafka Alfred Chakty", "Rafka Nazih Hadchity",
"Rawan Jamal Naboulsi", "Rawan Samih Darwich", "Ray Rabih Nehme", "Ray Yazbeck Chehade", "Rayan Ghassan Hamzeh",
"Rayan Imad Alagha", "Razan Bahaa El Kadi", "Rebecca Antoine Tannous", "Richard Raymond Bouty", "Riwa Hanna Sarkis",
"Rony Tony Zoghby", "Roudy Marky Ayoub", "Roudy Sarkis Frangieh", "Safaa Rabie El Mir", "Said Hani Abdul Ghani",
"Said Miled Saliba", "Sally Fouad Masri", "Sana Khaled Haj Khalil", "Sanaa Youssef Khalaf", "Sandy Ghassan Khaddour",
"Sedra Atallah Salah", "Serena Jean El Khoury", "Serena Marwan Khoury", "Serine Omar Arour", "Serrano Youssef Al Hajj",
"Simon Fadi Daoud", "Sindy Samir Tawk", "Sirine Houssam Tlayge", "Sleiman Ghaleb Saadeh", "Sleimen Al Wazir Georges Fadel",
"Sonia Charbel Dgheim", "Sonia Georges Dghaim", "Sophie Samer Sardouk", "Soulayma Dory Lteif", "Stephanie Estephan Sardouk",
"Steven Naim Morkos Douaihy", "Tatiana Assaad Khattar Rahme", "Tatiana Wissam Zammar", "Teddy Keyrouz Keyrouz", "Tia Antonios Bayssary",
"Toni Kabalan Frangieh", "Tony Dori Greije", "Tony Nabil Frangieh", "Tony Najib Hkayem", "Tony Wahib Finianos",
"Tony Youssef Frangieh", "Toufic Elie Radi", "Tracy Charbel Rouhana", "Vanessa Badoui Al Hazzouri", "Vanessa Pierre Gebrayel",
"Victor Nidal Al Najjar", "Wajih Wadih El Masri",
"Yara Elias Kheir", "Yorgo Charbel Al Alam", "Yousof Mohammad Houssein", "Youssef Houssein Ayash", "Youssef Mtanios Wehbe",
"Youssef Tony Makary"
];

const INITIAL_CANDIDATE_DATA = NAME_LIST.map((name, index) => ({
  id: index + 1,
  name: name,
  isElected: false,
  localId: String(index + 1).padStart(3, '0'),
}));


// --- Pie Chart Components (Simulated using SVG for demonstration) ---
const PieChartVisualization = ({ data }) => {
  const total = data.reduce((sum, item) => sum + item.value, 0);

  if (total === 0 && data.some(item => item.value === 0)) {
    return (
      <div className="flex flex-col items-center justify-center p-4">
        <div className="w-48 h-48 sm:w-64 sm:h-64 relative bg-gray-200 rounded-full flex items-center justify-center text-gray-500 font-semibold">
          No Data
        </div>
        <div className="mt-6 space-y-2 w-full max-w-xs text-center text-sm text-gray-500">
          No candidates available to calculate distribution.
        </div>
      </div>
    );
  }

  let cumulativePercentage = 0;

  const getStrokeDasharray = (value, color) => {
    const percentage = (value / total) * 100;
    const start = cumulativePercentage;
    cumulativePercentage += percentage;
    
    if (value === 0) return null;

    return (
      <circle
        key={color}
        r="30%"
        cx="50%"
        cy="50%"
        fill="none"
        stroke={color}
        strokeWidth="20%"
        strokeDasharray={`${percentage} ${100 - percentage}`}
        strokeDashoffset={`-${start}`}
        style={{ transition: 'stroke-dashoffset 0.5s ease' }}
      />
    );
  };

  return (
    <div className="flex flex-col items-center justify-center p-4">
      <div className="w-48 h-48 sm:w-64 sm:h-64 relative">
        <svg viewBox="0 0 100 100" className="w-full h-full transform -rotate-90">
          <circle r="30%" cx="50%" cy="50%" fill="#f3f4f6" stroke="none" />
          {data.map((item, index) => getStrokeDasharray(item.value, item.color))}
        </svg>
        <div className="absolute inset-0 flex items-center justify-center text-center">
          <div className="font-bold text-xl text-gray-800">
            {total} Total
          </div>
        </div>
      </div>
      <div className="mt-6 space-y-2 w-full max-w-xs">
        {data.map((entry, index) => (
          <div key={`legend-${index}`} className="flex justify-between items-center text-sm">
            <div className="flex items-center space-x-2">
              <span className="w-3 h-3 rounded-full shadow" style={{ backgroundColor: entry.color }}></span>
              <span className="font-medium text-gray-700">{entry.name}</span>
            </div>
            <span className="font-extrabold text-gray-900">
              {entry.value} ({total > 0 ? ((entry.value / total) * 100).toFixed(1) : '0.0'}%)
            </span>
          </div>
        ))}
      </div>
    </div>
  );
};


// --- Login Screen Component ---
const LoginScreen = ({ setMode }) => {
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');

  const handleLogin = (e) => {
    e.preventDefault();
    setError('');
    if (password === ADMIN_PASSWORD) {
      setMode('admin');
    } else {
      setError('Invalid password. Please try again.');
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-100 p-4">
      <div className="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-300 hover:shadow-3xl">
        <div className="text-center mb-8">
          <h1 className="text-3xl font-extrabold text-indigo-700">Election Console Access</h1>
          <p className="text-gray-500 mt-2">Select your role to continue.</p>
        </div>

        {/* Viewer Mode Access */}
        <button
          onClick={() => setMode('viewer')}
          className="w-full mb-4 px-6 py-3 bg-blue-600 text-white font-bold rounded-lg shadow-lg hover:bg-blue-700 transition-all duration-300 transform hover:scale-[1.02] active:scale-95 flex items-center justify-center"
        >
          <icons.Users className="w-5 h-5 mr-2"/> Continue as Viewer (Read-Only)
        </button>

        <div className="relative my-6">
          <div className="absolute inset-0 flex items-center">
            <div className="w-full border-t border-gray-300"></div>
          </div>
          <div className="relative flex justify-center text-sm">
            <span className="px-2 bg-white text-gray-500 font-semibold">OR ADMIN LOGIN</span>
          </div>
        </div>

        {/* Admin Login Form */}
        <form onSubmit={handleLogin}>
          <div className="mb-4">
            <label className="block text-sm font-medium text-gray-700 mb-1" htmlFor="password">
              Admin Password
            </label>
            <input
              id="password"
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              placeholder="Enter password for full control"
              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 shadow-inner transition-shadow"
            />
          </div>
          
          {error && (
            <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-lg mb-4 text-sm font-medium">
              {error}
            </div>
          )}

          <button
            type="submit"
            className="w-full px-6 py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-lg hover:bg-indigo-700 transition-all duration-300 transform hover:scale-[1.02] active:scale-95 flex items-center justify-center"
          >
            <icons.Trophy className="w-5 h-5 mr-2"/> Login as Administrator
          </button>
        </form>
      </div>
    </div>
  );
};


// --- MAIN APP COMPONENT ---
function App() {
  // Application Mode State: 'login', 'viewer', or 'admin'
  const [mode, setMode] = React.useState('login'); 

  // --- LOCAL STATE ONLY ---
  const [participants, setParticipants] = React.useState(INITIAL_CANDIDATE_DATA);
  
  // UI State
  const [filter, setFilter] = React.useState('ALL');
  const [searchTerm, setSearchTerm] = React.useState('');

  // No Firebase dependency, so no userId needed.

  // --- LOCAL State Update Function ---
  const updateStatus = (localId, newStatus) => {
    // Updates the status in local React state only
    setParticipants(prevParticipants => 
      prevParticipants.map(p => 
        p.localId === localId ? { ...p, isElected: newStatus } : p
      )
    );
  };


  // --- Calculations and Aggregations (Efficient Logic) ---
  const { totalCount, electedCount, notElectedCount, electedPercentage, chartData } = React.useMemo(() => {
    const total = participants.length;
    const elected = participants.filter(p => p.isElected).length;
    const notElected = total - elected;

    const electedPct = total > 0 ? ((elected / total) * 100).toFixed(1) : '0.0';
    const notElectedPct = total > 0 ? ((notElected / total) * 100).toFixed(1) : '0.0';

    const data = [
      { name: 'Elected', value: elected, color: COLORS[0], percentage: electedPct },
      { name: 'Not Elected', value: notElected, color: COLORS[1], percentage: notElectedPct },
    ];

    return {
      totalCount: total,
      electedCount: elected,
      notElectedCount: notElected,
      electedPercentage: electedPct,
      chartData: data,
    };
  }, [participants]);

  // --- Filtering & Searching Logic ---
  const filteredParticipants = React.useMemo(() => {
    let list = participants;

    // 1. Apply Election Status Filter
    if (filter === 'ELECTED') {
      list = list.filter(p => p.isElected);
    } else if (filter === 'NOT_ELECTED') {
      list = list.filter(p => !p.isElected);
    }

    // 2. Apply Search Term Filter
    if (searchTerm) {
      const lowerCaseSearchTerm = searchTerm.toLowerCase();
      list = list.filter(p => p.name.toLowerCase().includes(lowerCaseSearchTerm));
    }
    
    return list.sort((a, b) => a.id - b.id);
  }, [participants, filter, searchTerm]);

  // --- Utility Functions ---
  const getFilterButtonClass = (buttonFilter) =>
    `px-4 py-2 text-sm font-bold rounded-lg transition-all duration-300 transform shadow-md ${
      filter === buttonFilter
        ? 'bg-indigo-700 text-white hover:bg-indigo-800'
        : 'bg-white text-gray-700 border border-gray-300 hover:bg-indigo-50 active:scale-95'
    }`;

  // --- Dashboard Card Component ---
  const StatCard = ({ title, value, icon: Icon, colorClass, percentage }) => (
    <div className="bg-white p-5 rounded-xl shadow-lg border-b-4 border-indigo-500 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
      <div className="flex items-start justify-between">
        <div>
          <p className="text-sm font-medium text-gray-500">{title}</p>
          <p className="text-3xl font-extrabold text-gray-900 mt-1">{value}</p>
        </div>
        <div className={`p-3 rounded-full ${colorClass} bg-opacity-20`}>
          <Icon className={`w-6 h-6 ${colorClass}`} />
        </div>
      </div>
      {percentage && (
        <p className="mt-3 text-sm">
          <span className={`font-extrabold ${colorClass}`}>
            {percentage}%
          </span>
          <span className="text-gray-500"> of total participants</span>
        </p>
      )}
    </div>
  );
  
  if (mode === 'login') {
      return <LoginScreen setMode={setMode} />;
  }
  
  // No loading state needed as data is instant
  // if (isLoading || !userId) { ... }

  // --- Main Content Render ---
  return (
    <div className="min-h-screen bg-gray-50 p-4 sm:p-8 font-inter">
      <header className="mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center">
        <div>
          <h1 className="text-3xl sm:text-4xl font-extrabold text-gray-900 tracking-tight">
            Professional Election Status Console
          </h1>
          <p className="text-lg text-gray-500 mt-1">
            Mode: 
            <strong className={`font-extrabold ml-1 ${mode === 'admin' ? 'text-indigo-600' : 'text-blue-600'}`}>
              {mode === 'admin' ? 'ADMINISTRATOR (Full Control)' : 'VIEWER (Read-Only)'}
            </strong>
          </p>
        </div>
        <div className="mt-4 sm:mt-0 text-right flex items-center space-x-3">
          <span className="text-sm font-semibold text-gray-600 bg-red-100 px-3 py-1 rounded-full shadow-inner">
            LOCAL SESSION ONLY (NOT SAVED)
          </span>
          <button 
            onClick={() => setMode('login')}
            className="px-3 py-1 text-sm font-bold rounded-lg bg-red-500 text-white hover:bg-red-600 transition-colors shadow-md"
            title="Switch back to login screen"
          >
            Exit Console
          </button>
        </div>
      </header>

      {/* --- Dashboard Metrics (Calculations) --- */}
      <section className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
        <StatCard
          title="Total Candidates"
          value={totalCount}
          icon={icons.Users}
          colorClass="text-indigo-600"
        />
        <StatCard
          title="Elected Candidates"
          value={electedCount}
          icon={icons.Trophy}
          colorClass="text-yellow-600"
          percentage={electedPercentage}
        />
        <StatCard
          title="Not Elected (Remaining)"
          value={notElectedCount}
          icon={icons.XCircle}
          colorClass="text-blue-600"
          percentage={(100 - electedPercentage).toFixed(1)}
        />
      </section>

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {/* --- Visualization (Pie Chart) --- */}
        <section className="lg:col-span-1 bg-white p-6 rounded-xl shadow-2xl z-10">
          <h2 className="text-xl font-bold text-gray-800 mb-4 border-b pb-2">
              Election Status Distribution
          </h2>
          <div className="flex justify-center items-center">
            <PieChartVisualization data={chartData} />
          </div>
        </section>

        {/* --- List, Filters, and Search --- */}
        <section className="lg:col-span-2 bg-white p-6 rounded-xl shadow-2xl relative z-20">
          <div className="mb-6">
            <h2 className="text-xl font-bold text-gray-800 border-b pb-2">
              Candidate Control Panel ({filteredParticipants.length})
            </h2>
          </div>

          {/* Search and Filter Controls Row */}
          <div className="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4 relative z-20">
            {/* Search Input */}
            <div className="relative w-full sm:w-1/2">
              <icons.Search className="w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2" />
              <input
                type="text"
                placeholder="Search candidate by name..."
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
                className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition-shadow duration-200 shadow-inner"
              />
            </div>

            {/* Filter Buttons */}
            <div className="flex space-x-3 items-center">
              <icons.Filter className="w-5 h-5 text-gray-500 hidden sm:block" />
              <button
                onClick={() => setFilter('ALL')}
                className={getFilterButtonClass('ALL')}
              >
                All
              </button>
              <button
                onClick={() => setFilter('ELECTED')}
                className={getFilterButtonClass('ELECTED')}
              >
                Elected ({electedCount})
              </button>
              <button
                onClick={() => setFilter('NOT_ELECTED')}
                className={getFilterButtonClass('NOT_ELECTED')}
              >
                Remaining ({notElectedCount})
              </button>
            </div>
          </div>

          {/* Candidate List */}
          <div className="max-h-[70vh] overflow-y-auto space-y-3 pr-2 custom-scrollbar">
            {filteredParticipants.length > 0 ? (
              filteredParticipants.map((p) => (
                <div
                  key={p.localId} 
                  className={`flex items-center justify-between p-4 rounded-xl transition-all duration-300 ease-in-out border-2 shadow-sm hover:shadow-lg ${
                    p.isElected
                      ? 'bg-yellow-100 border-yellow-500' 
                      : 'bg-blue-100 border-blue-500'
                  }`}
                >
                  <div className="flex flex-col sm:flex-row sm:items-center space-x-0 sm:space-x-4">
                    <span className="text-sm font-mono text-gray-600 mr-2 w-10 hidden sm:inline-block font-bold">{p.id}</span>
                    <span className="text-base font-semibold text-gray-900">{p.name}</span>
                  </div>
                  <div className="flex items-center space-x-3">
                    <span
                      className={`px-3 py-1 text-xs font-extrabold rounded-full min-w-[110px] text-center shadow ${
                        p.isElected
                          ? 'bg-yellow-600 text-gray-900'
                          : 'bg-blue-600 text-white'
                      }`}
                    >
                      {p.isElected ? '✅ ELECTED' : '❌ REMAINING'}
                    </span>
                    
                    {/* Status Toggle Button (Visible only in Admin Mode) */}
                    {mode === 'admin' && (
                        <button
                          onClick={() => updateStatus(p.localId, !p.isElected)}
                          title={`Toggle Status to ${p.isElected ? 'Not Elected' : 'Elected'}`}
                          className={`p-2 rounded-full text-white transition-all duration-300 hover:scale-110 active:scale-90 shadow-md ${
                            p.isElected 
                              ? 'bg-blue-700 hover:bg-blue-800'
                              : 'bg-yellow-700 hover:bg-yellow-800'
                          }`}
                        >
                          {p.isElected ? <icons.XCircle className="w-4 h-4" /> : <icons.CheckCircle className="w-4 h-4" />}
                        </button>
                    )}
                  </div>
                </div>
              ))
            ) : (
              <div className="text-center py-12 text-gray-600 bg-gray-50 border-4 border-dashed border-indigo-300 rounded-xl">
                <icons.Search className="w-8 h-8 mx-auto mb-2 text-indigo-500" />
                <p className="font-semibold">No Candidates Found</p>
                <p className="text-sm text-gray-500">Please adjust your search term or filter settings.</p>
              </div>
            )}
          </div>
        </section>
      </div>

      <style jsx="true">{`
        /* Custom scrollbar for better aesthetics */
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background-color: #9ca3af; /* gray-400 */
          border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background-color: #f3f4f6; /* gray-100 */
        }
      `}</style>
    </div>
  );
}

// === Render the App ===
const container = document.getElementById('root');
if (container) {
  const root = ReactDOM.createRoot(container);
  root.render(<App />);
}
</script>
</body>
</html>